# Apollo Server

This is a sample AWS Lambda function that demonstrates how to create a GraphQL API using Apollo Server, Nexus, and Prisma. 
The Lambda function exposes a GraphQL API, connecting to a PostgreSQL database through Prisma for data management.

## Prerequisites

1. Node.js (12.x or higher)
2. npm (6.x or higher)
3. AWS Account (for deploying the Lambda function)
4. Docker Desktop

## Directory Structure

```
.
├── prisma
│   └── schema.prisma
├── src
│   └── index.js
├── docker-compose.yml
├── package-lock.json
├── package.json
├── serverless.yml
├── tsconfig.json
├── .env
└── README.md
```

`/index.ts` : Code for the lambda that hosts the GraphQL API

`/.env` : Contains a database connection URL

`/serverless.yml` : AWS Template for deploying the lambda

`/docker-compose.yml` : Definition for running the database build script

`/docker/initialize-pg-database.sql` : Builds database & tables locally, fills with seed data

`/prisma/schema.prisma` : An autogenerated file containing a schema for quick conversion of GQL <-> SQL

## Getting Started

### 1. Clone the repository & Install dependencies

```
  git clone https://github.com/devinobrien-css/advanced-search.git

  cd advanced-search-example

  npm install
```

### 2. Use Docker to build the Postgres instance

This example uses a local instance of Postgres. 
Run docker compose up to launch the database at `localhost:5432`

```
    docker-compose up -d
```

Your PostgreSQL database should now be up and running. 
You can access it using your preferred PostgreSQL client or 
command-line tool with the following connection details:

* **Host**: localhost (or 127.0.0.1)
* **Port**: 5432 (the port mapping we defined in the docker-compose.yml file)
* **Username**: postgres
* **Password**: temporary
* **Database**: LocalDatabase

### 3. Set up Prisma:

Generate Prisma client:

`npx prisma generate`

Define your GraphQL types, queries, and mutations in the path/to/your/nexus/schema.js file.
Deploy the Lambda function:





## Environment Variables
DATABASE_URL: The connection URL to a Postgres database.

## Handler Function
The Lambda function uses the graphqlHandler function in src/index.js as the entry point.
This function serves as the bridge between the AWS Lambda environment and Apollo Server.

## Contributing
Contributions are welcome! If you find any issues or want to add improvements, feel free to submit a pull request.

## License
This project is licensed under the MIT License - see the LICENSE file for details.

## Documentation
AWS Lambda Documentation
Prisma Documentation
Apollo Server Documentation
Nexus Documentation

## Credits
Apollo Server
Nexus
Prisma

